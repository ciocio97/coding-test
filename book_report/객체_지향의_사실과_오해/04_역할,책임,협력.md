> 객체 지향에 갓 입문한 사람들의 흔한 실수는, **협력** 이라는 **문맥** 을 고려하지 않은 채 
> **객체** 가 가져야 할 **상태** 나 **행동** 부터 고민하기 시작한다는 것이다.
> 
> 개별적인 객체의 행동이나 상태가 아니라 객체들 간의 **협력** 에 집중하라.

<br/>

## 협력

`협력은 다수의 요청과 응답의 흐름으로 구성된다.` 

<img width="600" alt="04-1" src="https://github.com/ciocio97/today_i_learned/assets/80025242/e95597b4-bd36-43e6-bfa7-008867e06757">
<p></p>


| 객체명 | 객체의 지식(상태) | 객체의 행동 방식(행동) | 객체의 의무(상태 + 행동) | ? |
| --- | --- | --- | --- | --- |
| 왕 | 재판에 필요한 지식 | 재판을 수행한다 | 재판을 수행할 의무(책임) | 판사 |
| 하얀 토끼 | 목격자에 대한 지식 | 목격자를 부른다 | 목격자를 부를 의무(책임) | 진행자 |
| 모자 장수 | 재판에 도움이 될 수 있는 정보 | 증언한다 | 증언할 의무(책임) | 증인 |

* 객체들이 **협력** 할 수 있는 이유는,  
  특정한 요청에 응답하고 요청할 수 있는 **지식** 과 **행동 방식** 을 가지고 있기 때문이다.
    
* **요청** 과 **응답** 은 협력에 참여하는 객체가 수행해야 할 **책임** 을 정의한다.
* 어떤 객체가 수행하는 **책임의 집합** 은 결국 객체가 협력 안에서 수행하는 **역할**을 암시한다.

<br/>

## 책임

`책임은 객체에 의해 정의되는 응집도 있는 행위의 집합이다.`  
`책임은 객체가 알아야하는 정보(knowing)와 객체가 수행할 수 있는 행위(doing)의 집합이다.`

<img width="600" alt="04-2" src="https://github.com/ciocio97/today_i_learned/assets/80025242/18ee2b29-0792-46f7-9232-a9544cabd6c4">
<p></p>

* 하는 것(doing)
    * 객체를 생성하거나 계산하는 등, 스스로 하는 것
        * 모자장수 → 하얀토끼 ‘증인석에 입장한다.’
        * 모자장수 → 왕 ’증언한다.’
    * 다른 객체의 행동을 시작시키는 것
        * 하얀토끼 → 모자장수 ‘증인석에 입장해주세요.’
    * 다른 객체의 활동을 제어하고 조절하는 것
        * 왕 → 하얀토끼 ‘목격자를 불러와라!’
        * 왕 → 모자장수 ‘증언을 하라!’, '증언을 멈춰라!'

<p style="color: red">Q  다른 객체의 행동을 시작시키는 것과 제어하고 조절하는 것의 차이는 ?</p>

* 아는 것(knowing)
    * 개인적인 정보에 관해 아는 것
    * 관련된 객체에 관해 아는 것
        * 하얀토끼 ‘목격자는 {모자장수}다.’
    * 자신이 유도하거나 계산할 수 있는 것에 관해 아는 것
        * 모자장수 ‘OOO 보았다. DDD 보았다.’

<p style="color: red">Q  아는 것의 종류를 구분하는 의미는 ?</p>

* **책임** 은 객체의 **공용 인터페이스** (public interface)를 구성한다. - 차후 **캡슐화** 와 연결
    * 객체의 외부에 제공해줄 수 있는 정보(knowing)와 서비스(doing)의 목록이 곧 책임이기 때문이다.
    * 대체가 가능하다면 인터페이스라고 볼 수 있다.
* 하나의 책임은 보통 여러 메세지로 분할된다. (책임과 메세지의 수준이 언제나 동일하지는 않다)
    * 객체가 다른 객체에게 주어진 책임을 수행하도록 요청을 보내는 것을 메세지 전송(message-send)이라고 한다.  
    협력을 요청하는 객체가 송신자, 요청을 응답하는 객체를 수신자라고 한다.
    * 메세지는 협력을 위해 한 객체가 다른 객체로 접근할 수 있는 유일한 방법이다.

<br/>

## 역할

`협력 내에서 특정 객체를 다른 객체로 대체할 수 있음을 나타내는 일종의 표식`  
`재사용 가능하고 유연한 객체 지향 설계를 낳는 구성요소`

<img width="754" alt="04-3" src="https://github.com/ciocio97/today_i_learned/assets/80025242/f7af2428-6775-437c-aeac-f0baa4e9619c">
<p></p>

* 3개의 서로 다른 재판 과정 (3개의 협력)
    * 동일한 구조의 협력을 다양한 문맥에서 재사용할 수 있는 능력은 **객체지향**만의 힘이다.
* **역할**을 이용해 **협력을 추상화**하면, 어떤 객체라도 협력에 참여할 수 있게 된다 
  (역할을 대체할 수 있는 객체는 동일한 메세지를 이해하고, 동일한 책임을 수행할 수 있는 객체로 한정.)
    
    * 특징
        * 유사한 협력을 추상화하여 인지 과부하를 줄일 수 있다. - **simplicity** (단순성)
        * 다양한 객체들이 협력에 참여할 수 있기 때문에 **협력** 이 좀 더 유연해진다. - **flexibility** (유연성)
        * 다양한 **객체** 들이 동일한 협력에 참여할 수 있기 때문에 재사용성이 높아진다. - **reusability** (재사용성)
    * 장점
        * 설계자가 다뤄야하는 협력의 개수를 줄임
        * 구체적인 객체를 추상적인 역할로 대체할 수 있음
        * 애플리케이션 설계를 이해하고 기억하기 쉬워짐
* 객체는 역할이 암시하는 책임보다 더 많은 책임을 가질 수 있다.
    * 대부분의 경우에 **객체의 타입** 과 **역할** 사이에는 **일반화/특수화** 관계가 성립한다.  
      (더 일반적인 개념을 의미하는 역할은 일반화이며, 더 구체적인 개념을 의미하는 타입은 특수화다.)
    * 타입은 하나, 역할(인터페이스)은 여러개를 가질 수 있다.

<p style="color: red">Q 역할은 협력을 중점에 둔 추상화이고, 타입은 객체를 중점에 둔 추상화인가 ..?</p>

<br/>

## 객체 지향 설계 기법

역할, 책임, 협력의 관점에서 애플리케이션을 쉽게 설계하는 유용한 3가지 방법을 살펴보자.

1. 책임주도 설계 (Responsibility-Driven Design)
   객체의 책임을 중심으로 시스템을 구축하는 설계 방법.  
   (협력에 필요한 책임들을 먼저 식별하고, 적합한 객체에게 책임을 할당하는 방식으로 애플리케이션을 설계한다.)
        
        1. 시스템이 사용자에게 제공해야 하는 기능인, 시스템 책임을 파악한다.
        2. 시스템 책임을 더 작은 책임으로 분할한다.
        3. 분할된 책임을 수행할 수 있는 적절한 객체 또는 역할을 찾아 책임을 할당한다.
        4. 객체가 책임을 수행하는 중에 다른 객체의 도움이 필요한 경우, 이를 책임질 적정한 객체 또는 역할을 찾는다.
        5. 해당 객체 또는 역할에게 책임을 할당함으로써 두 객체가 협력하게 한다.


2. 디자인 패턴 (Design Pattern)
    1. 전문가들이 반복적으로 사용하는 해결방법을 정의해 놓은 설계 템플릿 모음  
       (특정한 상황에서 설계를 돕기 위해 모방하고 수정할 수 있는 과거의 설계 경험)

    2. 책임주도 설계의 결과를 표현

    3. 일반적으로 디자인 패턴은 반복적으로 발생하는 문제와 그 문제에 대한 해법의 쌍으로 정의되며,  
       어떤 패턴이 특정한 상황에 왜 적합한지 이유에 대해 설명한다. 

    4. [디자인 패턴들](https://refactoring.guru/ko/design-patterns)  
       decorator pattern vs composite pattern
   
<p class="color: red">Q 실무에서 적용해보거나 적용된 케이스를 공유해주실 수 있나요 ?</p>
   
3. 테스트주도 개발 (Test-Driven Development)
    1. 테스트주도 개발은 책임주도 설계의 기본 개념을 따른다.

    2. 테스트 주도 개발의 실제 목적은 테스트 작성이 아니라,  
       구체적인 코드를 작성해나가면서 역할, 책임, 협력을 식별하고  
       식별된 역할, 책임, 협력이 적합한지를 피드백받는 것이다. 오
        
    3. 책임주도 설계를 통해 도달해야 하는 목적지를  
       테스트라는 안전 장치를 통해 좀 더 빠르고 견고한 방법으로 도달할 수 있도록 해주는 최상의 설계 방법.
        
    4. 테스트주도 개발의 기본 흐름

        1. 실패하는 테스트를 작성
        2. 테스트를 통과하는 가장 간단한 코드를 작성
        3. 리팩토링을 통해 중복을 제거